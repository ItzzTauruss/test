-- Create the main UI frame
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.Name = "ToggleableUI"

-- Create the UI frame that can be toggled and dragged
local uiFrame = Instance.new("Frame")
uiFrame.Size = UDim2.new(0, 300, 0, 150)
uiFrame.Position = UDim2.new(0, 100, 0, 100)
uiFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
uiFrame.Visible = false  -- Initially hidden
uiFrame.Parent = ScreenGui

-- Create a title bar for dragging
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 30)
titleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
titleBar.Parent = uiFrame

-- Add text to the title bar
local titleText = Instance.new("TextLabel")
titleText.Size = UDim2.new(1, 0, 1, 0)
titleText.BackgroundTransparency = 1
titleText.Text = "Drag Me!"
titleText.TextColor3 = Color3.fromRGB(255, 255, 255)
titleText.TextSize = 18
titleText.Parent = titleBar

-- Create the toggle button
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, 100, 0, 30)
toggleButton.Position = UDim2.new(0.5, -50, 1, 10)
toggleButton.Text = "Toggle UI"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
toggleButton.Parent = uiFrame

-- Toggle function
toggleButton.MouseButton1Click:Connect(function()
    uiFrame.Visible = not uiFrame.Visible
end)

-- Draggable UI
local dragging = false
local dragInput, mousePos, framePos

titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        mousePos = input.Position
        framePos = uiFrame.Position
    end
end)

titleBar.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - mousePos
        uiFrame.Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X, framePos.Y.Scale, framePos.Y.Offset + delta.Y)
    end
end)

titleBar.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- Create the function to start the script
local function createUI()
    -- Ensure everything is initialized correctly
    ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    uiFrame.Parent = ScreenGui
end

-- Call the function to create the UI
createUI()
